<?xml version="1.0" encoding="UTF-8"?><!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd"><html xmlns="http://www.w3.org/1999/xhtml" lang="en"><head><meta http-equiv="Content-Type" content="text/html;charset=UTF-8"/><link rel="stylesheet" href="../jacoco-resources/report.css" type="text/css"/><link rel="shortcut icon" href="../jacoco-resources/report.gif" type="image/gif"/><title>TaskInfo.java</title><link rel="stylesheet" href="../jacoco-resources/prettify.css" type="text/css"/><script type="text/javascript" src="../jacoco-resources/prettify.js"></script></head><body onload="window['PR_TAB_WIDTH']=4;prettyPrint()"><div class="breadcrumb" id="breadcrumb"><span class="info"><a href="../jacoco-sessions.html" class="el_session">Sessions</a></span><a href="../index.html" class="el_report">Flink : Core</a> &gt; <a href="index.source.html" class="el_package">org.apache.flink.api.common</a> &gt; <span class="el_source">TaskInfo.java</span></div><h1>TaskInfo.java</h1><pre class="source lang-java linenums">/*
 * Licensed to the Apache Software Foundation (ASF) under one
 * or more contributor license agreements.  See the NOTICE file
 * distributed with this work for additional information
 * regarding copyright ownership.  The ASF licenses this file
 * to you under the Apache License, Version 2.0 (the
 * &quot;License&quot;); you may not use this file except in compliance
 * with the License.  You may obtain a copy of the License at
 *
 *     http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an &quot;AS IS&quot; BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */

package org.apache.flink.api.common;

import org.apache.flink.annotation.Internal;

import static org.apache.flink.util.Preconditions.checkArgument;
import static org.apache.flink.util.Preconditions.checkNotNull;

/**
 * Encapsulates task-specific information: name, index of subtask, parallelism and attempt number.
 */
@Internal
public class TaskInfo {

    private final String taskName;
    private final String taskNameWithSubtasks;
    private final String allocationIDAsString;
    private final int maxNumberOfParallelSubtasks;
    private final int indexOfSubtask;
    private final int numberOfParallelSubtasks;
    private final int attemptNumber;

    public TaskInfo(
            String taskName,
            int maxNumberOfParallelSubtasks,
            int indexOfSubtask,
            int numberOfParallelSubtasks,
            int attemptNumber) {
<span class="fc" id="L46">        this(</span>
                taskName,
                maxNumberOfParallelSubtasks,
                indexOfSubtask,
                numberOfParallelSubtasks,
                attemptNumber,
                &quot;UNKNOWN&quot;);
<span class="fc" id="L53">    }</span>

    public TaskInfo(
            String taskName,
            int maxNumberOfParallelSubtasks,
            int indexOfSubtask,
            int numberOfParallelSubtasks,
            int attemptNumber,
<span class="fc" id="L61">            String allocationIDAsString) {</span>

<span class="pc bpc" id="L63" title="1 of 2 branches missed.">        checkArgument(indexOfSubtask &gt;= 0, &quot;Task index must be a non-negative number.&quot;);</span>
<span class="pc bpc" id="L64" title="1 of 2 branches missed.">        checkArgument(</span>
                maxNumberOfParallelSubtasks &gt;= 1, &quot;Max parallelism must be a positive number.&quot;);
<span class="pc bpc" id="L66" title="1 of 2 branches missed.">        checkArgument(</span>
                maxNumberOfParallelSubtasks &gt;= numberOfParallelSubtasks,
                &quot;Max parallelism must be &gt;= than parallelism.&quot;);
<span class="pc bpc" id="L69" title="1 of 2 branches missed.">        checkArgument(numberOfParallelSubtasks &gt;= 1, &quot;Parallelism must be a positive number.&quot;);</span>
<span class="pc bpc" id="L70" title="1 of 2 branches missed.">        checkArgument(</span>
                indexOfSubtask &lt; numberOfParallelSubtasks,
                &quot;Task index must be less than parallelism.&quot;);
<span class="pc bpc" id="L73" title="1 of 2 branches missed.">        checkArgument(attemptNumber &gt;= 0, &quot;Attempt number must be a non-negative number.&quot;);</span>
<span class="fc" id="L74">        this.taskName = checkNotNull(taskName, &quot;Task Name must not be null.&quot;);</span>
<span class="fc" id="L75">        this.maxNumberOfParallelSubtasks = maxNumberOfParallelSubtasks;</span>
<span class="fc" id="L76">        this.indexOfSubtask = indexOfSubtask;</span>
<span class="fc" id="L77">        this.numberOfParallelSubtasks = numberOfParallelSubtasks;</span>
<span class="fc" id="L78">        this.attemptNumber = attemptNumber;</span>
<span class="fc" id="L79">        this.taskNameWithSubtasks =</span>
                taskName
                        + &quot; (&quot;
                        + (indexOfSubtask + 1)
                        + '/'
                        + numberOfParallelSubtasks
                        + ')'
                        + &quot;#&quot;
                        + attemptNumber;
<span class="fc" id="L88">        this.allocationIDAsString = checkNotNull(allocationIDAsString);</span>
<span class="fc" id="L89">    }</span>

    /**
     * Returns the name of the task
     *
     * @return The name of the task
     */
    public String getTaskName() {
<span class="fc" id="L97">        return this.taskName;</span>
    }

    /** Gets the max parallelism aka the max number of subtasks. */
    public int getMaxNumberOfParallelSubtasks() {
<span class="nc" id="L102">        return maxNumberOfParallelSubtasks;</span>
    }

    /**
     * Gets the number of this parallel subtask. The numbering starts from 0 and goes up to
     * parallelism-1 (parallelism as returned by {@link #getNumberOfParallelSubtasks()}).
     *
     * @return The index of the parallel subtask.
     */
    public int getIndexOfThisSubtask() {
<span class="fc" id="L112">        return this.indexOfSubtask;</span>
    }

    /**
     * Gets the parallelism with which the parallel task runs.
     *
     * @return The parallelism with which the parallel task runs.
     */
    public int getNumberOfParallelSubtasks() {
<span class="fc" id="L121">        return this.numberOfParallelSubtasks;</span>
    }

    /**
     * Gets the attempt number of this parallel subtask. First attempt is numbered 0. The attempt
     * number corresponds to the number of times this task has been restarted(after
     * failure/cancellation) since the job was initially started.
     *
     * @return Attempt number of the subtask.
     */
    public int getAttemptNumber() {
<span class="nc" id="L132">        return this.attemptNumber;</span>
    }

    /**
     * Returns the name of the task, appended with the subtask indicator, such as &quot;MyTask (3/6)#1&quot;,
     * where 3 would be ({@link #getIndexOfThisSubtask()} + 1), and 6 would be {@link
     * #getNumberOfParallelSubtasks()}, and 1 would be {@link #getAttemptNumber()}.
     *
     * @return The name of the task, with subtask indicator.
     */
    public String getTaskNameWithSubtasks() {
<span class="nc" id="L143">        return this.taskNameWithSubtasks;</span>
    }

    /**
     * Returns the allocation id for where this task is executed.
     *
     * @return the allocation id for where this task is executed.
     */
    public String getAllocationIDAsString() {
<span class="nc" id="L152">        return allocationIDAsString;</span>
    }
}
</pre><div class="footer"><span class="right">Created with <a href="http://www.jacoco.org/jacoco">JaCoCo</a> 0.8.7.202105040129</span></div></body></html>