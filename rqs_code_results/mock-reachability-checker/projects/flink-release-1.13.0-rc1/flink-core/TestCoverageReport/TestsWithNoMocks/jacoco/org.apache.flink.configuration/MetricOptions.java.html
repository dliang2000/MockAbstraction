<?xml version="1.0" encoding="UTF-8"?><!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd"><html xmlns="http://www.w3.org/1999/xhtml" lang="en"><head><meta http-equiv="Content-Type" content="text/html;charset=UTF-8"/><link rel="stylesheet" href="../jacoco-resources/report.css" type="text/css"/><link rel="shortcut icon" href="../jacoco-resources/report.gif" type="image/gif"/><title>MetricOptions.java</title><link rel="stylesheet" href="../jacoco-resources/prettify.css" type="text/css"/><script type="text/javascript" src="../jacoco-resources/prettify.js"></script></head><body onload="window['PR_TAB_WIDTH']=4;prettyPrint()"><div class="breadcrumb" id="breadcrumb"><span class="info"><a href="../jacoco-sessions.html" class="el_session">Sessions</a></span><a href="../index.html" class="el_report">Flink : Core</a> &gt; <a href="index.source.html" class="el_package">org.apache.flink.configuration</a> &gt; <span class="el_source">MetricOptions.java</span></div><h1>MetricOptions.java</h1><pre class="source lang-java linenums">/*
 * Licensed to the Apache Software Foundation (ASF) under one
 * or more contributor license agreements.  See the NOTICE file
 * distributed with this work for additional information
 * regarding copyright ownership.  The ASF licenses this file
 * to you under the Apache License, Version 2.0 (the
 * &quot;License&quot;); you may not use this file except in compliance
 * with the License.  You may obtain a copy of the License at
 *
 *     http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an &quot;AS IS&quot; BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */

package org.apache.flink.configuration;

import org.apache.flink.annotation.PublicEvolving;
import org.apache.flink.annotation.docs.Documentation;
import org.apache.flink.configuration.description.Description;

import java.time.Duration;

import static org.apache.flink.configuration.ConfigOptions.key;
import static org.apache.flink.configuration.description.TextElement.text;

/** Configuration options for metrics and metric reporters. */
@PublicEvolving
public class MetricOptions {

    /**
     * An optional list of reporter names. If configured, only reporters whose name matches any of
     * the names in the list will be started. Otherwise, all reporters that could be found in the
     * configuration will be started.
     *
     * &lt;p&gt;Example:
     *
     * &lt;pre&gt;{@code
     * metrics.reporters = foo,bar
     *
     * metrics.reporter.foo.class = org.apache.flink.metrics.reporter.JMXReporter
     * metrics.reporter.foo.interval = 10
     *
     * metrics.reporter.bar.class = org.apache.flink.metrics.graphite.GraphiteReporter
     * metrics.reporter.bar.port = 1337
     * }&lt;/pre&gt;
     */
<span class="fc" id="L51">    public static final ConfigOption&lt;String&gt; REPORTERS_LIST =</span>
<span class="fc" id="L52">            key(&quot;metrics.reporters&quot;)</span>
<span class="fc" id="L53">                    .noDefaultValue()</span>
<span class="fc" id="L54">                    .withDescription(</span>
                            &quot;An optional list of reporter names. If configured, only reporters whose name matches&quot;
                                    + &quot; any of the names in the list will be started. Otherwise, all reporters that could be found in&quot;
                                    + &quot; the configuration will be started.&quot;);

<span class="fc" id="L59">    public static final ConfigOption&lt;String&gt; REPORTER_CLASS =</span>
<span class="fc" id="L60">            key(&quot;metrics.reporter.&lt;name&gt;.class&quot;)</span>
<span class="fc" id="L61">                    .noDefaultValue()</span>
<span class="fc" id="L62">                    .withDescription(&quot;The reporter class to use for the reporter named &lt;name&gt;.&quot;);</span>

<span class="fc" id="L64">    public static final ConfigOption&lt;Duration&gt; REPORTER_INTERVAL =</span>
<span class="fc" id="L65">            key(&quot;metrics.reporter.&lt;name&gt;.interval&quot;)</span>
<span class="fc" id="L66">                    .durationType()</span>
<span class="fc" id="L67">                    .defaultValue(Duration.ofSeconds(10))</span>
<span class="fc" id="L68">                    .withDescription(&quot;The reporter interval to use for the reporter named &lt;name&gt;.&quot;);</span>

<span class="fc" id="L70">    public static final ConfigOption&lt;String&gt; REPORTER_CONFIG_PARAMETER =</span>
<span class="fc" id="L71">            key(&quot;metrics.reporter.&lt;name&gt;.&lt;parameter&gt;&quot;)</span>
<span class="fc" id="L72">                    .noDefaultValue()</span>
<span class="fc" id="L73">                    .withDescription(</span>
                            &quot;Configures the parameter &lt;parameter&gt; for the reporter named &lt;name&gt;.&quot;);

    /** The delimiter used to assemble the metric identifier. */
<span class="fc" id="L77">    public static final ConfigOption&lt;String&gt; SCOPE_DELIMITER =</span>
<span class="fc" id="L78">            key(&quot;metrics.scope.delimiter&quot;)</span>
<span class="fc" id="L79">                    .defaultValue(&quot;.&quot;)</span>
<span class="fc" id="L80">                    .withDescription(&quot;Delimiter used to assemble the metric identifier.&quot;);</span>

    /** The scope format string that is applied to all metrics scoped to a JobManager. */
<span class="fc" id="L83">    public static final ConfigOption&lt;String&gt; SCOPE_NAMING_JM =</span>
<span class="fc" id="L84">            key(&quot;metrics.scope.jm&quot;)</span>
<span class="fc" id="L85">                    .defaultValue(&quot;&lt;host&gt;.jobmanager&quot;)</span>
<span class="fc" id="L86">                    .withDescription(</span>
                            &quot;Defines the scope format string that is applied to all metrics scoped to a JobManager.&quot;);

    /** The scope format string that is applied to all metrics scoped to a TaskManager. */
<span class="fc" id="L90">    public static final ConfigOption&lt;String&gt; SCOPE_NAMING_TM =</span>
<span class="fc" id="L91">            key(&quot;metrics.scope.tm&quot;)</span>
<span class="fc" id="L92">                    .defaultValue(&quot;&lt;host&gt;.taskmanager.&lt;tm_id&gt;&quot;)</span>
<span class="fc" id="L93">                    .withDescription(</span>
                            &quot;Defines the scope format string that is applied to all metrics scoped to a TaskManager.&quot;);

    /** The scope format string that is applied to all metrics scoped to a job on a JobManager. */
<span class="fc" id="L97">    public static final ConfigOption&lt;String&gt; SCOPE_NAMING_JM_JOB =</span>
<span class="fc" id="L98">            key(&quot;metrics.scope.jm.job&quot;)</span>
<span class="fc" id="L99">                    .defaultValue(&quot;&lt;host&gt;.jobmanager.&lt;job_name&gt;&quot;)</span>
<span class="fc" id="L100">                    .withDescription(</span>
                            &quot;Defines the scope format string that is applied to all metrics scoped to a job on a JobManager.&quot;);

    /** The scope format string that is applied to all metrics scoped to a job on a TaskManager. */
<span class="fc" id="L104">    public static final ConfigOption&lt;String&gt; SCOPE_NAMING_TM_JOB =</span>
<span class="fc" id="L105">            key(&quot;metrics.scope.tm.job&quot;)</span>
<span class="fc" id="L106">                    .defaultValue(&quot;&lt;host&gt;.taskmanager.&lt;tm_id&gt;.&lt;job_name&gt;&quot;)</span>
<span class="fc" id="L107">                    .withDescription(</span>
                            &quot;Defines the scope format string that is applied to all metrics scoped to a job on a TaskManager.&quot;);

    /** The scope format string that is applied to all metrics scoped to a task. */
<span class="fc" id="L111">    public static final ConfigOption&lt;String&gt; SCOPE_NAMING_TASK =</span>
<span class="fc" id="L112">            key(&quot;metrics.scope.task&quot;)</span>
<span class="fc" id="L113">                    .defaultValue(</span>
                            &quot;&lt;host&gt;.taskmanager.&lt;tm_id&gt;.&lt;job_name&gt;.&lt;task_name&gt;.&lt;subtask_index&gt;&quot;)
<span class="fc" id="L115">                    .withDescription(</span>
                            &quot;Defines the scope format string that is applied to all metrics scoped to a task.&quot;);

    /** The scope format string that is applied to all metrics scoped to an operator. */
<span class="fc" id="L119">    public static final ConfigOption&lt;String&gt; SCOPE_NAMING_OPERATOR =</span>
<span class="fc" id="L120">            key(&quot;metrics.scope.operator&quot;)</span>
<span class="fc" id="L121">                    .defaultValue(</span>
                            &quot;&lt;host&gt;.taskmanager.&lt;tm_id&gt;.&lt;job_name&gt;.&lt;operator_name&gt;.&lt;subtask_index&gt;&quot;)
<span class="fc" id="L123">                    .withDescription(</span>
                            &quot;Defines the scope format string that is applied to all metrics scoped to an operator.&quot;);

<span class="fc" id="L126">    public static final ConfigOption&lt;Long&gt; LATENCY_INTERVAL =</span>
<span class="fc" id="L127">            key(&quot;metrics.latency.interval&quot;)</span>
<span class="fc" id="L128">                    .defaultValue(0L)</span>
<span class="fc" id="L129">                    .withDescription(</span>
                            &quot;Defines the interval at which latency tracking marks are emitted from the sources.&quot;
                                    + &quot; Disables latency tracking if set to 0 or a negative value. Enabling this feature can significantly&quot;
                                    + &quot; impact the performance of the cluster.&quot;);

<span class="fc" id="L134">    public static final ConfigOption&lt;String&gt; LATENCY_SOURCE_GRANULARITY =</span>
<span class="fc" id="L135">            key(&quot;metrics.latency.granularity&quot;)</span>
<span class="fc" id="L136">                    .defaultValue(&quot;operator&quot;)</span>
<span class="fc" id="L137">                    .withDescription(</span>
<span class="fc" id="L138">                            Description.builder()</span>
<span class="fc" id="L139">                                    .text(</span>
                                            &quot;Defines the granularity of latency metrics. Accepted values are:&quot;)
<span class="fc" id="L141">                                    .list(</span>
<span class="fc" id="L142">                                            text(</span>
                                                    &quot;single - Track latency without differentiating between sources and subtasks.&quot;),
<span class="fc" id="L144">                                            text(</span>
                                                    &quot;operator - Track latency while differentiating between sources, but not subtasks.&quot;),
<span class="fc" id="L146">                                            text(</span>
                                                    &quot;subtask - Track latency while differentiating between sources and subtasks.&quot;))
<span class="fc" id="L148">                                    .build());</span>

    /** The number of measured latencies to maintain at each operator. */
<span class="fc" id="L151">    public static final ConfigOption&lt;Integer&gt; LATENCY_HISTORY_SIZE =</span>
<span class="fc" id="L152">            key(&quot;metrics.latency.history-size&quot;)</span>
<span class="fc" id="L153">                    .defaultValue(128)</span>
<span class="fc" id="L154">                    .withDescription(</span>
                            &quot;Defines the number of measured latencies to maintain at each operator.&quot;);

    /**
     * Whether Flink should report system resource metrics such as machine's CPU, memory or network
     * usage.
     */
<span class="fc" id="L161">    public static final ConfigOption&lt;Boolean&gt; SYSTEM_RESOURCE_METRICS =</span>
<span class="fc" id="L162">            key(&quot;metrics.system-resource&quot;)</span>
<span class="fc" id="L163">                    .defaultValue(false)</span>
<span class="fc" id="L164">                    .withDescription(</span>
                            &quot;Flag indicating whether Flink should report system resource metrics such as machine's CPU,&quot;
                                    + &quot; memory or network usage.&quot;);
    /**
     * Interval between probing of system resource metrics specified in milliseconds. Has an effect
     * only when {@link #SYSTEM_RESOURCE_METRICS} is enabled.
     */
<span class="fc" id="L171">    public static final ConfigOption&lt;Long&gt; SYSTEM_RESOURCE_METRICS_PROBING_INTERVAL =</span>
<span class="fc" id="L172">            key(&quot;metrics.system-resource-probing-interval&quot;)</span>
<span class="fc" id="L173">                    .defaultValue(5000L)</span>
<span class="fc" id="L174">                    .withDescription(</span>
                            &quot;Interval between probing of system resource metrics specified in milliseconds. Has an effect&quot;
                                    + &quot; only when '&quot;
<span class="fc" id="L177">                                    + SYSTEM_RESOURCE_METRICS.key()</span>
                                    + &quot;' is enabled.&quot;);

    /**
     * The default network port range for Flink's internal metric query service. The {@code &quot;0&quot;}
     * means that Flink searches for a free port.
     */
    @Documentation.Section(Documentation.Sections.COMMON_HOST_PORT)
<span class="fc" id="L185">    public static final ConfigOption&lt;String&gt; QUERY_SERVICE_PORT =</span>
<span class="fc" id="L186">            key(&quot;metrics.internal.query-service.port&quot;)</span>
<span class="fc" id="L187">                    .defaultValue(&quot;0&quot;)</span>
<span class="fc" id="L188">                    .withDescription(</span>
                            &quot;The port range used for Flink's internal metric query service. Accepts a list of ports &quot;
                                    + &quot;(“50100,50101”), ranges(“50100-50200”) or a combination of both. It is recommended to set a range of &quot;
                                    + &quot;ports to avoid collisions when multiple Flink components are running on the same machine. Per default &quot;
                                    + &quot;Flink will pick a random port.&quot;);

    /**
     * The thread priority for Flink's internal metric query service. The {@code 1} means the min
     * priority and the {@code 10} means the max priority.
     */
<span class="fc" id="L198">    public static final ConfigOption&lt;Integer&gt; QUERY_SERVICE_THREAD_PRIORITY =</span>
<span class="fc" id="L199">            key(&quot;metrics.internal.query-service.thread-priority&quot;)</span>
<span class="fc" id="L200">                    .defaultValue(1)</span>
<span class="fc" id="L201">                    .withDescription(</span>
                            &quot;The thread priority used for Flink's internal metric query service. The thread is created&quot;
                                    + &quot; by Akka's thread pool executor. &quot;
                                    + &quot;The range of the priority is from 1 (MIN_PRIORITY) to 10 (MAX_PRIORITY). &quot;
                                    + &quot;Warning, increasing this value may bring the main Flink components down.&quot;);
    /**
     * The config parameter defining the update interval for the metric fetcher used by the web UI
     * in milliseconds.
     */
<span class="fc" id="L210">    public static final ConfigOption&lt;Long&gt; METRIC_FETCHER_UPDATE_INTERVAL =</span>
<span class="fc" id="L211">            key(&quot;metrics.fetcher.update-interval&quot;)</span>
<span class="fc" id="L212">                    .defaultValue(10000L)</span>
<span class="fc" id="L213">                    .withDescription(</span>
                            &quot;Update interval for the metric fetcher used by the web UI in milliseconds. Decrease this value for &quot;
                                    + &quot;faster updating metrics. Increase this value if the metric fetcher causes too much load. Setting this value to 0 &quot;
                                    + &quot;disables the metric fetching completely.&quot;);

    private MetricOptions() {}
}
</pre><div class="footer"><span class="right">Created with <a href="http://www.jacoco.org/jacoco">JaCoCo</a> 0.8.7.202105040129</span></div></body></html>