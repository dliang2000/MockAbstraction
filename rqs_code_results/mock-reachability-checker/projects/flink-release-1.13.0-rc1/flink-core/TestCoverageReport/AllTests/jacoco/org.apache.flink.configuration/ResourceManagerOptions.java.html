<?xml version="1.0" encoding="UTF-8"?><!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd"><html xmlns="http://www.w3.org/1999/xhtml" lang="en"><head><meta http-equiv="Content-Type" content="text/html;charset=UTF-8"/><link rel="stylesheet" href="../jacoco-resources/report.css" type="text/css"/><link rel="shortcut icon" href="../jacoco-resources/report.gif" type="image/gif"/><title>ResourceManagerOptions.java</title><link rel="stylesheet" href="../jacoco-resources/prettify.css" type="text/css"/><script type="text/javascript" src="../jacoco-resources/prettify.js"></script></head><body onload="window['PR_TAB_WIDTH']=4;prettyPrint()"><div class="breadcrumb" id="breadcrumb"><span class="info"><a href="../jacoco-sessions.html" class="el_session">Sessions</a></span><a href="../index.html" class="el_report">Flink : Core</a> &gt; <a href="index.source.html" class="el_package">org.apache.flink.configuration</a> &gt; <span class="el_source">ResourceManagerOptions.java</span></div><h1>ResourceManagerOptions.java</h1><pre class="source lang-java linenums">/*
 * Licensed to the Apache Software Foundation (ASF) under one
 * or more contributor license agreements.  See the NOTICE file
 * distributed with this work for additional information
 * regarding copyright ownership.  The ASF licenses this file
 * to you under the Apache License, Version 2.0 (the
 * &quot;License&quot;); you may not use this file except in compliance
 * with the License.  You may obtain a copy of the License at
 *
 *     http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an &quot;AS IS&quot; BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */

package org.apache.flink.configuration;

import org.apache.flink.annotation.PublicEvolving;
import org.apache.flink.annotation.docs.Documentation;
import org.apache.flink.configuration.description.Description;

import java.time.Duration;

/** The set of configuration options relating to the ResourceManager. */
@PublicEvolving
public class ResourceManagerOptions {

    private static final String START_WORKER_RETRY_INTERVAL_KEY =
            &quot;resourcemanager.start-worker.retry-interval&quot;;

    /** Timeout for jobs which don't have a job manager as leader assigned. */
<span class="nc" id="L35">    public static final ConfigOption&lt;String&gt; JOB_TIMEOUT =</span>
<span class="nc" id="L36">            ConfigOptions.key(&quot;resourcemanager.job.timeout&quot;)</span>
<span class="nc" id="L37">                    .defaultValue(&quot;5 minutes&quot;)</span>
<span class="nc" id="L38">                    .withDescription(</span>
                            &quot;Timeout for jobs which don't have a job manager as leader assigned.&quot;);

    /** This option is not used any more. */
    @Deprecated
<span class="nc" id="L43">    public static final ConfigOption&lt;Integer&gt; LOCAL_NUMBER_RESOURCE_MANAGER =</span>
<span class="nc" id="L44">            ConfigOptions.key(&quot;local.number-resourcemanager&quot;)</span>
<span class="nc" id="L45">                    .defaultValue(1)</span>
<span class="nc" id="L46">                    .withDescription(&quot;The number of resource managers start.&quot;);</span>

    /**
     * Defines the network port to connect to for communication with the resource manager. By
     * default, the port of the JobManager, because the same ActorSystem is used. Its not possible
     * to use this configuration key to define port ranges.
     */
<span class="nc" id="L53">    public static final ConfigOption&lt;Integer&gt; IPC_PORT =</span>
<span class="nc" id="L54">            ConfigOptions.key(&quot;resourcemanager.rpc.port&quot;)</span>
<span class="nc" id="L55">                    .defaultValue(0)</span>
<span class="nc" id="L56">                    .withDescription(</span>
                            &quot;Defines the network port to connect to for communication with the resource manager. By&quot;
                                    + &quot; default, the port of the JobManager, because the same ActorSystem is used.&quot;
                                    + &quot; Its not possible to use this configuration key to define port ranges.&quot;);

    @Documentation.Section(Documentation.Sections.EXPERT_SCHEDULING)
<span class="nc" id="L62">    public static final ConfigOption&lt;Integer&gt; MAX_SLOT_NUM =</span>
<span class="nc" id="L63">            ConfigOptions.key(&quot;slotmanager.number-of-slots.max&quot;)</span>
<span class="nc" id="L64">                    .intType()</span>
<span class="nc" id="L65">                    .defaultValue(Integer.MAX_VALUE)</span>
<span class="nc" id="L66">                    .withDescription(</span>
                            &quot;Defines the maximum number of slots that the Flink cluster allocates. This configuration option &quot;
                                    + &quot;is meant for limiting the resource consumption for batch workloads. It is not recommended to configure this option &quot;
                                    + &quot;for streaming workloads, which may fail if there are not enough slots. Note that this configuration option does not take &quot;
                                    + &quot;effect for standalone clusters, where how many slots are allocated is not controlled by Flink.&quot;);

    @Documentation.ExcludeFromDocumentation(
            &quot;This is only needed by FinGrainedSlotManager, which it still in development.&quot;)
<span class="nc" id="L74">    public static final ConfigOption&lt;Double&gt; MAX_TOTAL_CPU =</span>
<span class="nc" id="L75">            ConfigOptions.key(&quot;slotmanager.max-total-resource.cpu&quot;)</span>
<span class="nc" id="L76">                    .doubleType()</span>
<span class="nc" id="L77">                    .noDefaultValue()</span>
<span class="nc" id="L78">                    .withDescription(</span>
                            &quot;Maximum cpu cores the Flink cluster allocates for slots. Resources &quot;
                                    + &quot;for JobManager and TaskManager framework are excluded. If &quot;
                                    + &quot;not configured, it will be derived from '&quot;
<span class="nc" id="L82">                                    + MAX_SLOT_NUM.key()</span>
                                    + &quot;'.&quot;);

    @Documentation.ExcludeFromDocumentation(
            &quot;This is only needed by FinGrainedSlotManager, which it still in development.&quot;)
<span class="nc" id="L87">    public static final ConfigOption&lt;MemorySize&gt; MAX_TOTAL_MEM =</span>
<span class="nc" id="L88">            ConfigOptions.key(&quot;slotmanager.max-total-resource.memory&quot;)</span>
<span class="nc" id="L89">                    .memoryType()</span>
<span class="nc" id="L90">                    .noDefaultValue()</span>
<span class="nc" id="L91">                    .withDescription(</span>
                            &quot;Maximum memory size the Flink cluster allocates for slots. Resources &quot;
                                    + &quot;for JobManager and TaskManager framework are excluded. If &quot;
                                    + &quot;not configured, it will be derived from '&quot;
<span class="nc" id="L95">                                    + MAX_SLOT_NUM.key()</span>
                                    + &quot;'.&quot;);

    /**
     * The number of redundant task managers. Redundant task managers are extra task managers
     * started by Flink, in order to speed up job recovery in case of failures due to task manager
     * lost. Note that this feature is available only to the active deployments (native K8s, Yarn
     * and Mesos).
     */
<span class="nc" id="L104">    public static final ConfigOption&lt;Integer&gt; REDUNDANT_TASK_MANAGER_NUM =</span>
<span class="nc" id="L105">            ConfigOptions.key(&quot;slotmanager.redundant-taskmanager-num&quot;)</span>
<span class="nc" id="L106">                    .intType()</span>
<span class="nc" id="L107">                    .defaultValue(0)</span>
<span class="nc" id="L108">                    .withDescription(</span>
                            &quot;The number of redundant task managers. Redundant task managers are extra task managers &quot;
                                    + &quot;started by Flink, in order to speed up job recovery in case of failures due to task manager lost. &quot;
                                    + &quot;Note that this feature is available only to the active deployments (native K8s, Yarn and Mesos).&quot;);

    /**
     * The maximum number of start worker failures (Native Kubernetes / Yarn / Mesos) per minute
     * before pausing requesting new workers. Once the threshold is reached, subsequent worker
     * requests will be postponed to after a configured retry interval ({@link
     * #START_WORKER_RETRY_INTERVAL}).
     */
<span class="nc" id="L119">    public static final ConfigOption&lt;Double&gt; START_WORKER_MAX_FAILURE_RATE =</span>
<span class="nc" id="L120">            ConfigOptions.key(&quot;resourcemanager.start-worker.max-failure-rate&quot;)</span>
<span class="nc" id="L121">                    .doubleType()</span>
<span class="nc" id="L122">                    .defaultValue(10.0)</span>
<span class="nc" id="L123">                    .withDescription(</span>
                            &quot;The maximum number of start worker failures (Native Kubernetes / Yarn / Mesos) per minute &quot;
                                    + &quot;before pausing requesting new workers. Once the threshold is reached, subsequent &quot;
                                    + &quot;worker requests will be postponed to after a configured retry interval ('&quot;
                                    + START_WORKER_RETRY_INTERVAL_KEY
                                    + &quot;').&quot;);

    /**
     * The time to wait before requesting new workers (Native Kubernetes / Yarn / Mesos) once the
     * max failure rate of starting workers ({@link #START_WORKER_MAX_FAILURE_RATE}) is reached.
     */
<span class="nc" id="L134">    public static final ConfigOption&lt;Duration&gt; START_WORKER_RETRY_INTERVAL =</span>
<span class="nc" id="L135">            ConfigOptions.key(START_WORKER_RETRY_INTERVAL_KEY)</span>
<span class="nc" id="L136">                    .durationType()</span>
<span class="nc" id="L137">                    .defaultValue(Duration.ofSeconds(3))</span>
<span class="nc" id="L138">                    .withDescription(</span>
                            &quot;The time to wait before requesting new workers (Native Kubernetes / Yarn / Mesos) once the &quot;
                                    + &quot;max failure rate of starting workers ('&quot;
<span class="nc" id="L141">                                    + START_WORKER_MAX_FAILURE_RATE.key()</span>
                                    + &quot;') is reached.&quot;);

    /**
     * The timeout for a slot request to be discarded, in milliseconds.
     *
     * @deprecated Use {@link JobManagerOptions#SLOT_REQUEST_TIMEOUT}.
     */
    @Deprecated
<span class="nc" id="L150">    public static final ConfigOption&lt;Long&gt; SLOT_REQUEST_TIMEOUT =</span>
<span class="nc" id="L151">            ConfigOptions.key(&quot;slotmanager.request-timeout&quot;)</span>
<span class="nc" id="L152">                    .defaultValue(-1L)</span>
<span class="nc" id="L153">                    .withDescription(&quot;The timeout for a slot request to be discarded.&quot;);</span>

    /**
     * Time in milliseconds of the start-up period of a standalone cluster. During this time,
     * resource manager of the standalone cluster expects new task executors to be registered, and
     * will not fail slot requests that can not be satisfied by any current registered slots. After
     * this time, it will fail pending and new coming requests immediately that can not be satisfied
     * by registered slots. If not set, {@link #SLOT_REQUEST_TIMEOUT} will be used by default.
     */
<span class="nc" id="L162">    public static final ConfigOption&lt;Long&gt; STANDALONE_CLUSTER_STARTUP_PERIOD_TIME =</span>
<span class="nc" id="L163">            ConfigOptions.key(&quot;resourcemanager.standalone.start-up-time&quot;)</span>
<span class="nc" id="L164">                    .defaultValue(-1L)</span>
<span class="nc" id="L165">                    .withDescription(</span>
                            &quot;Time in milliseconds of the start-up period of a standalone cluster. During this time, &quot;
                                    + &quot;resource manager of the standalone cluster expects new task executors to be registered, and will not &quot;
                                    + &quot;fail slot requests that can not be satisfied by any current registered slots. After this time, it will &quot;
                                    + &quot;fail pending and new coming requests immediately that can not be satisfied by registered slots. If not &quot;
                                    + &quot;set, 'slotmanager.request-timeout' will be used by default.&quot;);

    /**
     * The timeout for an idle task manager to be released, in milliseconds.
     *
     * @deprecated Use {@link #TASK_MANAGER_TIMEOUT}.
     */
    @Deprecated
<span class="nc" id="L178">    public static final ConfigOption&lt;Long&gt; SLOT_MANAGER_TASK_MANAGER_TIMEOUT =</span>
<span class="nc" id="L179">            ConfigOptions.key(&quot;slotmanager.taskmanager-timeout&quot;)</span>
<span class="nc" id="L180">                    .defaultValue(30000L)</span>
<span class="nc" id="L181">                    .withDescription(&quot;The timeout for an idle task manager to be released.&quot;);</span>

    /** The timeout for an idle task manager to be released, in milliseconds. */
<span class="nc" id="L184">    public static final ConfigOption&lt;Long&gt; TASK_MANAGER_TIMEOUT =</span>
<span class="nc" id="L185">            ConfigOptions.key(&quot;resourcemanager.taskmanager-timeout&quot;)</span>
<span class="nc" id="L186">                    .defaultValue(30000L)</span>
<span class="nc" id="L187">                    .withDeprecatedKeys(SLOT_MANAGER_TASK_MANAGER_TIMEOUT.key())</span>
<span class="nc" id="L188">                    .withDescription(</span>
<span class="nc" id="L189">                            Description.builder()</span>
<span class="nc" id="L190">                                    .text(&quot;The timeout for an idle task manager to be released.&quot;)</span>
<span class="nc" id="L191">                                    .build());</span>

    /**
     * Release task executor only when each produced result partition is either consumed or failed.
     *
     * &lt;p&gt;Currently, produced result partition is released when it fails or consumer sends close
     * request to confirm successful end of consumption and to close the communication channel.
     *
     * @deprecated The default value should be reasonable enough in all cases, this option is to
     *     fallback to older behaviour which will be removed or refactored in future.
     */
    @Deprecated
<span class="nc" id="L203">    public static final ConfigOption&lt;Boolean&gt; TASK_MANAGER_RELEASE_WHEN_RESULT_CONSUMED =</span>
<span class="nc" id="L204">            ConfigOptions.key(&quot;resourcemanager.taskmanager-release.wait.result.consumed&quot;)</span>
<span class="nc" id="L205">                    .defaultValue(true)</span>
<span class="nc" id="L206">                    .withDescription(</span>
<span class="nc" id="L207">                            Description.builder()</span>
<span class="nc" id="L208">                                    .text(</span>
                                            &quot;Release task executor only when each produced result partition is either consumed or failed. &quot;
                                                    + &quot;'True' is default. 'False' means that idle task executor release is not blocked &quot;
                                                    + &quot;by receiver confirming consumption of result partition &quot;
                                                    + &quot;and can happen right away after 'resourcemanager.taskmanager-timeout' has elapsed. &quot;
                                                    + &quot;Setting this option to 'false' can speed up task executor release but can lead to unexpected failures &quot;
                                                    + &quot;if end of consumption is slower than 'resourcemanager.taskmanager-timeout'.&quot;)
<span class="nc" id="L215">                                    .build());</span>

    /**
     * Prefix for passing custom environment variables to Flink's master process. For example for
     * passing LD_LIBRARY_PATH as an env variable to the AppMaster, set:
     * containerized.master.env.LD_LIBRARY_PATH: &quot;/usr/lib/native&quot; in the flink-conf.yaml.
     */
    public static final String CONTAINERIZED_MASTER_ENV_PREFIX = &quot;containerized.master.env.&quot;;

    /**
     * Similar to the {@see CONTAINERIZED_MASTER_ENV_PREFIX}, this configuration prefix allows
     * setting custom environment variables for the workers (TaskManagers).
     */
    public static final String CONTAINERIZED_TASK_MANAGER_ENV_PREFIX =
            &quot;containerized.taskmanager.env.&quot;;

    /** Timeout for TaskManagers to register at the active resource managers. */
<span class="nc" id="L232">    public static final ConfigOption&lt;Duration&gt; TASK_MANAGER_REGISTRATION_TIMEOUT =</span>
<span class="nc" id="L233">            ConfigOptions.key(&quot;resourcemanager.taskmanager-registration.timeout&quot;)</span>
<span class="nc" id="L234">                    .durationType()</span>
<span class="nc" id="L235">                    .defaultValue(TaskManagerOptions.REGISTRATION_TIMEOUT.defaultValue())</span>
<span class="nc" id="L236">                    .withFallbackKeys(TaskManagerOptions.REGISTRATION_TIMEOUT.key())</span>
<span class="nc" id="L237">                    .withDescription(</span>
                            &quot;Timeout for TaskManagers to register at the active resource managers. &quot;
                                    + &quot;If exceeded, active resource manager will release and try to &quot;
                                    + &quot;re-request the resource for the worker. If not configured, &quot;
                                    + &quot;fallback to '&quot;
<span class="nc" id="L242">                                    + TaskManagerOptions.REGISTRATION_TIMEOUT.key()</span>
                                    + &quot;'.&quot;);

    // ---------------------------------------------------------------------------------------------

    /** Not intended to be instantiated. */
    private ResourceManagerOptions() {}
}
</pre><div class="footer"><span class="right">Created with <a href="http://www.jacoco.org/jacoco">JaCoCo</a> 0.8.7.202105040129</span></div></body></html>